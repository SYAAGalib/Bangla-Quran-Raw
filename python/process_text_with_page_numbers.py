import re

def clean_and_split_text(text):
    # Extract page numbers and replace them in the text with a placeholder
    page_numbers = page_number_search(text)
    page_number_placeholder = '<PAGE_NUMBER>'
    for page_number in page_numbers:
        text = text.replace(f'P-{page_number}', page_number_placeholder)

    # Step 1: Remove ayat numbers in parentheses
    text = re.sub(r'\(\d+\)', '', text)

    # Step 2: Strip unnecessary whitespace
    cleaned_text = text.strip()

    # Step 3: Escape special characters
    cleaned_text = escape_special_characters(cleaned_text)

    # Step 4: Split the cleaned text by Bengali periods but keep the period at the end of each line
    sentences = [sentence.strip() + '।' for sentence in re.split(r'(?<=।)\s*', cleaned_text) if sentence]

    # Ensure only a single Bengali period at the end of each line
    sentences = [re.sub(r'।{2,}', '।', sentence) for sentence in sentences]

    # Step 5: Re-insert page numbers at the appropriate positions
    result = []
    page_number_iter = iter(page_numbers)
    for sentence in sentences:
        if page_number_placeholder in sentence:
            # Add the page number
            result.append(next(page_number_iter))
            # Add the remainder of the sentence
            result.append(sentence.replace(page_number_placeholder, '').strip())
        else:
            result.append(sentence.strip())

    # Combine sentences with a single line break between them
    final_output = '\n'.join(result)
    
    return final_output

# Example usage with the provided text
text = """
P-141
(৭১) মু'মিন নর ও নারী একে অন্যের বন্ধু তারা সৎকাজের আদেশ দেয় এবং অসৎ কাজে নিষেধ করে, আর নামায প্রতিষ্ঠা করে, যাকাত প্রদান করে, আল্লাহ্ ও রাসূলের আনুগত্য করে, এদের প্রতিই আল্লাহর রহমত অবশ্যই বর্ষিত হবে। নিশ্চয়ই আল্লাহ প্রবল প্রতাপশালী। (৭২) আর আল্লাহ্ মু'মিন নর-নারীকে ওয়াদা দিলেন জান্নাতের যার নিচ দিয়ে ঝর্ণা ধারা প্রবাহিত। সেখানে তারা চিরকাল অবস্থান করবে, আর স্থায়ী জান্নাতে উত্তম সংরক্ষিত মহল; আর আল্লাহর সন্তুষ্টিই বড়, এটাই পরম সাফল্য। (৭৩) হে নবী! কাফির ও মুনাফিকদের বিরুদ্ধে যুদ্ধ করুন ও কঠোর হন, তাদের বাসস্থান জাহান্নাম, তা কতই না নিকৃষ্ট স্থান। (৭৪) তারা এরূপ বলেনি বলে আল্লাহর নামে শপথ করে, অথচ তারা অবশ্যই কুফুরী কথা বলেছে, মুসলিম হওয়ার পর কাফের হয়েছে, ইচ্ছা অনুযায়ী তা পায় নি; আর তারা কেবল এ কারণে বিরোধিতা করেছে যে আল্লাহ্ ও তাঁর রাসূল তাদেরকে স্বীয় কৃপায় বিত্তবান করেছিলেন। তারা যদি তওবা করে, তবে তাদেরই কল্যাণ হবে, আর যদি বিমুখ হয়, তবে ইহ-পরকালে আল্লাহ্ তাদেরকে পীড়াদায়ক শাস্তি দেবেন, অতএব এ দুনিয়ায় তারা তাদের কোন বন্ধু ও সাহায্যকারী পাবে না। (৭৫) তাদের কেউ কেউ আল্লাহর সঙ্গে ওয়াদা করে যে, আল্লাহ্ নিজ অনুগ্রহে দান করলে আমরা সদকা দিব ও সৎ হব। (৭৬) অতঃপর তিনি যখন তাদেরকে স্বীয় অনুগ্রহে দান করলেন, তখন তারা আরো অবাধ্য হয়ে অমান্য করল। (৭৭) আল্লাহ্র সঙ্গে মিলন অবধি তাদের মনে তিনি কপটতা স্থায়ী করে দিলেন; কেননা, তারা আল্লাহর সাথে কৃত ওয়াদা ভঙ্গ করেছে, এজন্য যে তারা মিথ্যাচারী। (৭৮) এটা কি তাদের জানা ছিল না যে, তাদের গোপন কথা ও গোপন পরামর্শ আল্লাহ্ জানেন? অদৃশ্যকে আল্লাহ্ ভালই জানেন। (৭৯) তারা সেসব লোক যারা ঠাট্টা বিদ্রূপ করে সেসব মু'মিনদের প্রতি যারা স্বেচ্ছায় সদকা দেয়, যারা নিজ শ্রম ছাড়া কিছুই পায় না, অতঃপর যারা তাদেরকে বিদ্রূপ করে, আল্লাহ্ তাদের নিন্দা করেন, তাদের জন্য রয়েছে পীড়াদায়ক শাস্তি।

(৮০) আপনার ক্ষমা প্রার্থনা করা না করা উভয়ই তাদের জন্য সমান, আপনি তাদের জন্য সত্তরবার দো'আ করলেও আল্লাহ্ ক্ষমা করবেন না; কেননা, তারা আল্লাহ ও রাসূলকে অস্বীকার করছে। আল্লাহ্ অবাধ্যদের হিদায়াত দেন না।

P-142
(৮১) যারা পিছনে থেকে গেল তারা আল্লাহ্ রাসূলের বিরুদ্ধাচরণ করে আনন্দ পেল, জান-মাল দ্বারা আল্লাহর রাস্তায় যুদ্ধকে অপছন্দ করল ও বলল, তোমরা গরমের ভেতর অভিযানে বের হয়ো না। বলুন, জাহান্নামের আগুন এ অপেক্ষাও গরম, যদি তারা বুঝত। (৮২) সুতরাং তারা এখন সামান্য হাসুক পরে অধিক কাঁদবে, এটাই তাদের কৃতকর্মের ফল। (৮৩) আল্লাহ্ আপনাকে তাদের দলের কাছে ফেরত আনল এবং তারা কোন অভিযানে বের হওয়ার জন্য অনুমতি চাইলে বলুন, তোমরা আমার সঙ্গে কখন ও বের হবে না এবং আমার সঙ্গে শত্রুদের বিরুদ্ধে কখনও যুদ্ধ করবে না, প্রথমেই তোমরা তো বসাকেই পছন্দ করেছ, তাই যারা পেছনে রয়েছে তাদের সাথে বসে থাক।

(৮৪) তাদের মধ্যে কেউ মরলে জানাযা পড়বে না, তাদের কবরের পাশে দাঁড়াবে না, কেননা, তারা তো কুফরী করেছে আল্লাহ্ ও রাসূলের সাথে। আর তারা অবাধ্য হয়ে মারা গেছে। (৮৫) আর আপনাকে যেন মুগ্ধ না করে তাদের ধন সম্পদ ও সন্তানাদি। তা দ্বারা আল্লাহ্ তাদেরকে দুনিয়ায় শাস্তি দিবেন, কাফের অবস্থায় তাদের প্রাণ বায়ু বের হবে। (৮৬) আর যখন নাযিল হয়, এ মর্মে কোন সূরা যে, ঈমান আন আল্লাহর প্রতি এবং রাসূলের সঙ্গী হয়ে জিহাদ কর, তখন তাদের মধ্যে সামর্থবানেরা আপনার নিকট অব্যাহতি চেয়ে বলে, আমাদের অব্যহতি দাও, আমরা বসে থাকা ব্যক্তিদের সঙ্গী হব। (৮৭) তারা নারীদের সঙ্গে পিছনে থাকতে খুশী, মহর মেরে দেয়া হল তাদের অন্তরে। ফলে তারা কিছুই বুঝে না। (৮৮) কিন্তু রাসূল ও যারা ঈমান এনেছে তারা জান-মাল দিয়ে আল্লাহর পথে যুদ্ধ করেছে, তাদের জন্য রয়েছে যাবতীয় কল্যাণ, তারাই সফলকাম। (৮৯) আল্লাহ্ তাদের জন্য এমন বেহেশত তৈরি করে রেখেছেন, যার নিছে ঝর্ণাধারা প্রবাহিত, সেথায় তারা স্থায়ী হবে, এটাই বড় সাফল্য।

P-143
(৯০) আর বেদুঈনদের মধ্যে কিছু বাহানাকারী বেদুঈন অব্যাহতি নেওয়ার জন্য আসে, আর আল্লাহ ও তাঁর রাসূলকে যারা মিথ্যা বলে তারা বসে রইল; তাদের মধ্যে যারা কুফুরী করেছে, তাদের জন্য রয়েছে মর্মদুন্ত শাস্তি। (৯১) কোন অপরাধ নেই তাদের যারা দুর্বল, পীড়িত এবং যারা অর্থদানে অসমর্থ তাদের যদি তারা আল্লাহ্ ও তাঁর রাসূলের প্রতি সৎ' খেয়াল রাখে; ভাল লোকদের প্রতিও কোন অভিযোগ নেই; আর আল্লাহ ক্ষমাশীল, দয়ালু। (৯২) আর তাদেরও কোন অপরাধ নেই যারা বাহনের জন্য আপনার নিকট এসেছিল, আপনি বলেছেন, আমার নিকট এমন কোন বাহন নেই যার উপর তোমরা সওয়ার হবে, তখন তারা ফিরে গেল। তারা অর্থদানে অসামর্থ হওয়ায় দুঃখে অশ্রু বিগলিত হচ্ছিল তাদের চোখ দিয়ে। (৯৩) অভিযোগের পথ তো তাদের বিরুদ্ধে, যারা ধনী হয়েও অব্যাহতি চায় তাদের পাপ আছে, তারা নারীর সঙ্গে পিছনে থাকাকে পছন্দ করে। আল্লাহ্ তাদের মনে মোহর মেরে দিয়েছেন, ফলে তারা কিছুই বুঝে না।
"""

# Extract page numbers
page_numbers = page_number_search(text)
print(f"Page Numbers: {page_numbers}")

# Extract and convert ayat numbers to English
ayat_numbers = ayat_number_search(text)
print(f"Ayat Numbers in English: {ayat_numbers}")

# Clean and split the text with page numbers
cleaned_sentences = clean_and_split_text(text)
print("\nCleaned and Split Sentences:")
print(cleaned_sentences)
